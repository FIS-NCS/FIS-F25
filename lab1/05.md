# Steganography

Hiding secret information within non-secret data.

- E.g., hiding text in an image/audio/video/document, or any file within another.
- Popular technique: hiding data in the least-significant bit ([LSB](https://ctf101.org/forensics/what-is-stegonagraphy/#lsb-steganography)) within file bytes.

## Hiding

- Install steghide

  ```bash
  sudo apt install steghide
  ```

- Download sample image

  ```bash
  wget -O cover-file.jpg https://upload.wikimedia.org/wikipedia/en/a/a9/Example.jpg
  ```

- Hide secret data in the image

  ```bash
  echo "Secret text" > embed-file.txt
  ```

  ```bash
  steghide embed -N -ef embed-file.txt -cf cover-file.jpg
  ```

- Extract the data

  ```bash
  steghide extract -sf cover-file.jpg -xf extracted.txt
  ```

  ```bash
  cat extracted.txt
  ```

- Steghide also compresses and encrypts data, this can be influenced by `-`z and `-e` parameter

## Detection

Detecting steganography is not particularly simple without knowing how or whether data is hidden. Helpful tools

1. **`file`**: Identifies a file's type by examining its header (magic bytes).
1. **`binwalk`**: Discovers and extracts hidden files and data embedded within another file.
1. **`xxd`**: Creates a hexdump of a file (or reverses one), allowing for manual binary analysis.
1. **`strings`**: Extracts all human-readable text from a binary file.
1. **`foremost`**: Recovers (carves) files from a disk image or binary blob based on their headers.
1. **`exiftool`**: Reads and writes metadata (EXIF, IPTC, etc.) from files like images and documents.
1. **`outguess`**: A steganography tool that hides data in the redundant bits of JPEG images.

## Exercise 4

- Find the flag embedded within the GIF utilizing the tools above. Format: `flag{...}`

  ```bash
  wget http://renderer:10082/workshop/content/steg.gif
  ```
  
  ![steg](steg.gif)
