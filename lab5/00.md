# Binary Exploitation (pwn)

Binary exploits are (arguably) the most complicated to understand, but may also be the most destructive when carried out.

- A [binary](https://en.wikipedia.org/wiki/Binary_file) is a non-text file (e.g., a JPEG image)
- An [executable](https://en.wikipedia.org/wiki/Executable) file contains runnable instructions (e.g., a BASH script).

Binary exploitation is about hacking *executable* binaries (mostly Linux [ELF](https://en.wikipedia.org/wiki/Executable_and_Linkable_Format)s and Windows [EXE](https://en.wikipedia.org/wiki/.exe)s.

## Popular Attacks

- **Buffer Overflow** --> Focus of this lab
- Return-Oriented Programming (ROP)
- Format String Vulnerabilities
- Use-After-Free (UAF)
- Time-of-Check Time-of-Use (TOCTOU) Exploits

## Popular Incidents

- [CVE-2021-3156](https://nvd.nist.gov/vuln/detail/cve-2021-3156): Heap-based overflow in `sudo`

    > Sudo before 1.9.5p2 contains an off-by-one error that can result in a **heap-based buffer overflow**, which allows **privilege escalation to root** via `sudoedit -s` and a command-line argument that ends with a single backslash character.

- [CVE-2014-0160](https://nvd.nist.gov/vuln/detail/cve-2014-0160): Heartbleed bug in OpenSSL
    > The (1) TLS and (2) DTLS implementations in OpenSSL 1.0.1 before 1.0.1g do not properly handle Heartbeat Extension packets, which allows **remote attackers** to obtain **sensitive information from process memory** via crafted packets that trigger a **buffer over-read**, as demonstrated by reading private keys, related to `d1_both.c` and `t1_lib.c`, aka the Heartbleed bug.

- [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/cve-2022-0847): Dirty pipe vulnerability in Linux kernel.
    > A flaw was found in the way the "flags" member of the new `pipe_buffer` structure was **lacking proper initialization** in `copy_page_to_iter_pipe` and `push_pipe` functions in the Linux kernel and could thus contain stale values. An unprivileged local user could use this flaw to write to pages in the page cache backed by read only files and as such **escalate their privileges** on the system.

## Defense Techniques

- Defense-in-depth: OS, Compiler, and Hardware Protections
  - Stack Protector (Canary)
  - Data Execution Prevention (DEP) / NX Bit
  - Address Space Layout Randomization (ASLR)
  - Control Flow Integrity (CFI)
  - Guard Pages

- Secure Coding Practices
  - Enforcing the using safe functions (guidelines)
  - Static and dynamic application security testing
  - Software fuzzing
