# Memory Forensics

Memory forensics involve analyzing a computer's memory [dump](https://forensics.wiki/memory_imaging/) to investigate cyberattacks that did not leave sufficient disk traces

- It helps understand information about running programs and the overall state of the OS when the dump was initiated.
- Memory content is typically dumped by default on crashes (e.g., Linux segfault or Windows BSOD), though different [tools](https://forensics.wiki/tools_memory_imaging/) can be used to manually dump specific memory regions.

## Practice

1. Install volatility3 (open-source memory forensics framework) with `pipx`

    ```bash
    sudo apt install -y pipx
    pipx install --include-deps volatility3
    pipx ensurepath
    vol # verify installation in a new terminal
    ```

1. Download sample memory dump. Tools like [LiME](https://github.com/504ensicsLabs/LiME) and [AVML](https://github.com/microsoft/avml) can be used to create one.

    ```bash
    wget -O mem.dump https://github.com/FIS-F25/lab6/releases/download/v1/mem.dump.tar.gz
    tar -xzvf mem.dump.tar.gz
    ```

1. Understand the kernel information of the obtained image.

    ```bash
    vol -f mem.dump banners
    ```

1. From there, we can either download the corresponding symbol table or generate one ourselves using [dwarf2json](https://github.com/volatilityfoundation/dwarf2json).
    > More info: <https://volatility3.readthedocs.io/en/latest/getting-started-linux-tutorial.html>

    ```bash
    cd ~/.local/share/pipx/venvs/volatility3/lib/python3.12/site-packages/volatility3/symbols/
    mkdir linux && cd linux
    wget https://github.com/Abyss-W4tcher/volatility3-symbols/raw/master/Ubuntu/amd64/5.4.0/150/generic/Ubuntu_5.4.0-150-generic_5.4.0-150.167~18.04.1_amd64.json.xz
    cd
    ```

1. Given the memory dump and symbols, volatility can make use of various plugins to extract useful information.

    ```bash
    vol -h | grep linux
    ```

1. Use a plugin to extract bash history from the dump

    ```bash
    vol -f mem.dump linux.bash
    ```

## Exercise 3

A PHP web application was running on the machine where `mem.dump` was obtained. Analyze the file with volatility to answer the questions:

- What was the IP address of the machine?
- When was the machine booted?
- We know that an attacker has uploaded a webshell to the site, find the location where the file was uploaded.
